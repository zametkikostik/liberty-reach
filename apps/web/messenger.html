<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liberty Reach ‚Äî Messenger</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            height: 100vh;
            overflow: hidden;
        }
        .app-container {
            display: flex;
            height: 100vh;
        }
        
        /* Sidebar */
        .sidebar {
            width: 350px;
            background: #fff;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
        }
        .sidebar-header {
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        .search-box {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        .search-input {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            font-size: 14px;
        }
        .conversations {
            flex: 1;
            overflow-y: auto;
        }
        .conversation-item {
            padding: 12px 16px;
            display: flex;
            gap: 12px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid #f5f5f5;
        }
        .conversation-item:hover {
            background: #f5f5f5;
        }
        .conversation-item.active {
            background: #e3f2fd;
        }
        .conv-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        .conv-info {
            flex: 1;
            overflow: hidden;
        }
        .conv-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }
        .conv-name {
            font-weight: 600;
            color: #111;
        }
        .conv-time {
            font-size: 12px;
            color: #999;
        }
        .conv-preview {
            font-size: 14px;
            color: #666;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .conv-unread {
            background: #5AC8FA;
            color: white;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        /* Chat Area */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #f5f5f5;
        }
        .chat-header {
            padding: 16px;
            background: white;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        .message {
            display: flex;
            margin-bottom: 16px;
            animation: fadeIn 0.3s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .message.sent {
            justify-content: flex-end;
        }
        .message-content {
            max-width: 60%;
            padding: 12px 16px;
            border-radius: 18px;
            position: relative;
        }
        .message.received .message-content {
            background: white;
            border-bottom-left-radius: 4px;
        }
        .message.sent .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom-right-radius: 4px;
        }
        .message-text {
            font-size: 15px;
            line-height: 1.4;
            word-wrap: break-word;
        }
        .message-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 6px;
            font-size: 12px;
            opacity: 0.7;
        }
        .message-time {
            font-size: 11px;
        }
        .message-status {
            font-size: 14px;
        }
        
        /* Message Input */
        .message-input-container {
            padding: 16px;
            background: white;
            border-top: 1px solid #e0e0e0;
        }
        .message-input-wrapper {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        .message-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 24px;
            font-size: 15px;
            resize: none;
            max-height: 120px;
            font-family: inherit;
        }
        .message-input:focus {
            outline: none;
            border-color: #667eea;
        }
        .send-button {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }
        .send-button:hover {
            transform: scale(1.05);
        }
        .input-actions {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        .action-button {
            padding: 8px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .action-button:hover {
            background: #f5f5f5;
        }
        
        /* Empty State */
        .empty-chat {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #999;
        }
        .empty-chat-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }
        
        /* Translation */
        .translate-badge {
            background: #e3f2fd;
            color: #1976d2;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            margin-top: 4px;
            display: inline-block;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">üõ°Ô∏è Liberty Reach</div>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">üë§</div>
                    <button onclick="logout()" style="background:none;border:1px solid rgba(255,255,255,0.3);color:white;padding:6px 12px;border-radius:6px;cursor:pointer;">Logout</button>
                </div>
            </div>
            
            <div class="search-box">
                <input type="text" class="search-input" placeholder="Search conversations..." id="searchInput" oninput="filterConversations()">
            </div>
            
            <div class="conversations" id="conversationsList">
                <!-- Conversations will be loaded here -->
            </div>
        </div>
        
        <!-- Chat Area -->
        <div class="chat-area">
            <div class="chat-header" id="chatHeader" style="display:none;">
                <div class="conv-avatar" id="chatAvatar">A</div>
                <div>
                    <div style="font-weight:600;" id="chatName">Alice</div>
                    <div style="font-size:13px;color:#666;" id="chatStatus">Online</div>
                </div>
            </div>
            
            <div class="chat-messages" id="chatMessages" style="display:none;">
                <!-- Messages will be loaded here -->
            </div>
            
            <div class="empty-chat" id="emptyChat">
                <div class="empty-chat-icon">üí¨</div>
                <h2>Welcome to Liberty Reach!</h2>
                <p>Select a conversation to start messaging</p>
                <p style="margin-top:10px;font-size:14px;">üîê End-to-end encrypted with CRYSTALS-Kyber-1024</p>
            </div>
            
            <div class="message-input-container" id="messageInputContainer" style="display:none;">
                <div class="message-input-wrapper">
                    <input type="text" class="message-input" placeholder="Type a message..." id="messageInput" onkeypress="handleKeyPress(event)">
                    <button class="send-button" onclick="sendMessage()">‚û§</button>
                </div>
                <div class="input-actions">
                    <button class="action-button" onclick="attachFile()">üìé Attach</button>
                    <button class="action-button" onclick="toggleVoiceMessage()">üé§ Voice</button>
                    <button class="action-button" onclick="toggleTranslation()">üåê Translate</button>
                    <button class="action-button" onclick="startVideoCall()">üìπ Video</button>
                    <button class="action-button" onclick="startVoiceCall()">üìû Call</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // State
        let currentUser = null;
        let currentConversation = null;
        let autoTranslate = false;
        
        // Mock data
        const conversations = [
            {
                id: '1',
                name: 'Alice Johnson',
                avatar: 'A',
                lastMessage: 'Hey! How are you?',
                time: '10:30 AM',
                unread: 2,
                messages: [
                    { id: '1', text: 'Hi there!', sent: false, time: '10:28 AM', status: 'read' },
                    { id: '2', text: 'Hey! How are you?', sent: false, time: '10:30 AM', status: 'read' }
                ]
            },
            {
                id: '2',
                name: 'Bob Smith',
                avatar: 'B',
                lastMessage: 'See you tomorrow!',
                time: 'Yesterday',
                unread: 0,
                messages: [
                    { id: '1', text: 'Are we still on for tomorrow?', sent: false, time: '3:00 PM', status: 'read' },
                    { id: '2', text: 'Yes, absolutely!', sent: true, time: '3:05 PM', status: 'read' },
                    { id: '3', text: 'See you tomorrow!', sent: false, time: '3:10 PM', status: 'read' }
                ]
            },
            {
                id: '3',
                name: 'Charlie Brown',
                avatar: 'C',
                lastMessage: 'Thanks for the help!',
                time: 'Monday',
                unread: 0,
                messages: [
                    { id: '1', text: 'Can you help me with this?', sent: false, time: '2:00 PM', status: 'read' },
                    { id: '2', text: 'Sure, what do you need?', sent: true, time: '2:05 PM', status: 'read' },
                    { id: '3', text: 'Thanks for the help!', sent: false, time: '2:30 PM', status: 'read' }
                ]
            },
            {
                id: '4',
                name: 'Diana Prince',
                avatar: 'D',
                lastMessage: 'üëç',
                time: 'Sunday',
                unread: 1,
                messages: [
                    { id: '1', text: 'Did you see the news?', sent: true, time: '1:00 PM', status: 'read' },
                    { id: '2', text: 'üëç', sent: false, time: '1:05 PM', status: 'delivered' }
                ]
            }
        ];
        
        // Initialize
        function init() {
            // Check session
            const savedUser = localStorage.getItem('username');
            if (!savedUser) {
                window.location.href = 'login.html';
                return;
            }
            
            currentUser = savedUser;
            document.getElementById('userAvatar').textContent = savedUser[0]?.toUpperCase() || 'üë§';
            
            loadConversations();
            startTypingSimulation();
        }
        
        // Load conversations
        function loadConversations() {
            const list = document.getElementById('conversationsList');
            list.innerHTML = '';
            
            conversations.forEach(conv => {
                const item = document.createElement('div');
                item.className = 'conversation-item';
                item.onclick = () => openConversation(conv.id);
                item.innerHTML = `
                    <div class="conv-avatar">${conv.avatar}</div>
                    <div class="conv-info">
                        <div class="conv-header">
                            <span class="conv-name">${conv.name}</span>
                            <span class="conv-time">${conv.time}</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <span class="conv-preview">${conv.lastMessage}</span>
                            ${conv.unread > 0 ? `<span class="conv-unread">${conv.unread}</span>` : ''}
                        </div>
                    </div>
                `;
                list.appendChild(item);
            });
        }
        
        // Filter conversations
        function filterConversations() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const items = document.querySelectorAll('.conversation-item');
            
            items.forEach(item => {
                const name = item.querySelector('.conv-name').textContent.toLowerCase();
                const preview = item.querySelector('.conv-preview').textContent.toLowerCase();
                
                if (name.includes(query) || preview.includes(query)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        
        // Open conversation
        function openConversation(convId) {
            currentConversation = conversations.find(c => c.id === convId);
            if (!currentConversation) return;
            
            // Update UI
            document.getElementById('emptyChat').style.display = 'none';
            document.getElementById('chatHeader').style.display = 'flex';
            document.getElementById('chatMessages').style.display = 'block';
            document.getElementById('messageInputContainer').style.display = 'block';
            
            document.getElementById('chatName').textContent = currentConversation.name;
            document.getElementById('chatAvatar').textContent = currentConversation.avatar;
            document.getElementById('chatStatus').textContent = 'Online';
            
            // Mark as read
            currentConversation.unread = 0;
            loadConversations();
            
            // Load messages
            loadMessages();
            
            // Highlight active
            document.querySelectorAll('.conversation-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
        }
        
        // Load messages
        function loadMessages() {
            const container = document.getElementById('chatMessages');
            container.innerHTML = '';
            
            currentConversation.messages.forEach(msg => {
                const messageEl = document.createElement('div');
                messageEl.className = `message ${msg.sent ? 'sent' : 'received'}`;
                messageEl.innerHTML = `
                    <div class="message-content">
                        <div class="message-text">${msg.text}</div>
                        <div class="message-meta">
                            <span class="message-time">${msg.time}</span>
                            ${msg.sent ? `<span class="message-status">${msg.status === 'read' ? '‚úì‚úì' : '‚úì'}</span>` : ''}
                        </div>
                        ${autoTranslate && !msg.sent ? '<div class="translate-badge">üåê Translated from English</div>' : ''}
                    </div>
                `;
                container.appendChild(messageEl);
            });
            
            container.scrollTop = container.scrollHeight;
        }
        
        // Send message
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text || !currentConversation) return;
            
            // Add message
            const newMessage = {
                id: Date.now().toString(),
                text: text,
                sent: true,
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                status: 'sent'
            };
            
            currentConversation.messages.push(newMessage);
            currentConversation.lastMessage = text;
            currentConversation.time = 'Now';
            
            // Update UI
            input.value = '';
            loadMessages();
            loadConversations();
            
            // Simulate reply
            setTimeout(() => {
                simulateReply();
            }, 2000 + Math.random() * 3000);
        }
        
        // Handle Enter key
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
        
        // Simulate reply
        function simulateReply() {
            if (!currentConversation) return;
            
            const replies = [
                'That\'s interesting!',
                'I see what you mean',
                'Tell me more',
                'üëç',
                'Haha, nice!',
                'I agree',
                'Let me think about it',
                'Sounds good!',
                'Thanks for letting me know',
                'üòä'
            ];
            
            const reply = {
                id: Date.now().toString(),
                text: replies[Math.floor(Math.random() * replies.length)],
                sent: false,
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                status: 'read'
            };
            
            currentConversation.messages.push(reply);
            currentConversation.lastMessage = reply.text;
            currentConversation.time = 'Now';
            
            loadMessages();
            loadConversations();
        }
        
        // Typing simulation
        function startTypingSimulation() {
            setInterval(() => {
                if (currentConversation && Math.random() > 0.7) {
                    document.getElementById('chatStatus').textContent = 'typing...';
                    setTimeout(() => {
                        document.getElementById('chatStatus').textContent = 'Online';
                    }, 2000);
                }
            }, 10000);
        }
        
        // Actions
        function attachFile() {
            alert('File attachment coming soon!');
        }
        
        function toggleVoiceMessage() {
            alert('Voice message recording coming soon!');
        }
        
        function toggleTranslation() {
            autoTranslate = !autoTranslate;
            alert(autoTranslate ? 'Translation enabled (50+ languages)' : 'Translation disabled');
            if (currentConversation) loadMessages();
        }
        
        function startVideoCall() {
            alert('Video call feature coming soon!');
        }
        
        function startVoiceCall() {
            alert('Voice call feature coming soon!');
        }
        
        // Logout
        function logout() {
            localStorage.removeItem('userId');
            localStorage.removeItem('token');
            localStorage.removeItem('username');
            window.location.href = 'login.html';
        }
        
        // Initialize app
        init();
    </script>
</body>
</html>
